import{j as e,c as a,P as t,T as n,A as r,t as s,v as i,I as o,V as d,w as l,B as c,x as g}from"./mui-bZH-AYFI.js";import{r as x,a as u}from"./vendor-DtzNP0b0.js";const m=({onLogin:m})=>{const[h,p]=x.useState(""),[b,f]=x.useState(""),[j,y]=x.useState(!1),[v,k]=x.useState(""),[S,w]=x.useState(!1),[W,A]=x.useState("...");u.useEffect(()=>{fetch("/api/health").then(e=>e.json()).then(e=>A(e.version||"1.0.0")).catch(()=>A("1.0.0"))},[]);return e.jsx(a,{sx:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"100vh",bgcolor:"background.default",background:e=>"dark"===e.palette.mode?"linear-gradient(135deg, #0f172a 0%, #1e293b 100%)":"linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%)"},children:e.jsxs(t,{elevation:0,sx:{p:5,maxWidth:450,width:"100%",mx:2,borderRadius:3,background:e=>"dark"===e.palette.mode?"rgba(30, 41, 59, 0.8)":"rgba(255, 255, 255, 0.95)",backdropFilter:"blur(20px)",border:e=>"dark"===e.palette.mode?"1px solid rgba(255, 255, 255, 0.1)":"1px solid rgba(0, 0, 0, 0.05)",boxShadow:e=>"dark"===e.palette.mode?"0 20px 60px -10px rgba(0, 0, 0, 0.5)":"0 20px 60px -10px rgba(0, 0, 0, 0.15)"},children:[e.jsxs(a,{sx:{mb:4,textAlign:"center"},children:[e.jsx(n,{variant:"h3",gutterBottom:!0,fontWeight:700,sx:{background:e=>"dark"===e.palette.mode?"linear-gradient(135deg, #60a5fa 0%, #a78bfa 100%)":"linear-gradient(135deg, #2563eb 0%, #7c3aed 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},children:"HAsync"}),e.jsx(n,{variant:"h6",color:"text.secondary",fontWeight:500,children:"Home Assistant Management"}),e.jsx(n,{variant:"body2",color:"text.secondary",sx:{mt:1},children:"Sign in to manage your devices and automations"})]}),v&&e.jsx(r,{severity:"error",sx:{mb:2},children:v}),e.jsxs("form",{onSubmit:async e=>{e.preventDefault(),k(""),w(!0);try{const e=await fetch("/api/admin/login",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({username:h,password:b})});if(!e.ok)throw new Error("Invalid username or password");const a=await e.json();a.user&&localStorage.setItem("user",JSON.stringify(a.user)),m(a.token||"",a.user)}catch(a){k(a.message||"Login failed. Please try again.")}finally{w(!1)}},children:[e.jsx(s,{fullWidth:!0,label:"Username",value:h,onChange:e=>p(e.target.value),margin:"normal",required:!0,autoFocus:!0,disabled:S}),e.jsx(s,{fullWidth:!0,label:"Password",type:j?"text":"password",value:b,onChange:e=>f(e.target.value),margin:"normal",required:!0,disabled:S,InputProps:{endAdornment:e.jsx(i,{position:"end",children:e.jsx(o,{onClick:()=>y(!j),edge:"end",children:j?e.jsx(d,{}):e.jsx(l,{})})})}}),e.jsx(c,{type:"submit",fullWidth:!0,variant:"contained",size:"large",disabled:S,startIcon:e.jsx(g,{}),sx:{mt:3},children:S?"Signing in...":"Sign In"})]}),e.jsx(a,{sx:{mt:4,textAlign:"center"},children:e.jsxs(n,{variant:"caption",color:"text.secondary",children:["HAsync v",W]})})]})})};export{m as LoginForm};
