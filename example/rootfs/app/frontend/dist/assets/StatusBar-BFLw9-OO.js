import{j as e,c as t,G as o,W as n,E as r,ag as s,ah as a,ak as i,al as c,am as l,an as d,T as x,I as u,ao as h,ap as j,S as p,A as f}from"./mui-bZH-AYFI.js";import{r as m}from"./vendor-DtzNP0b0.js";import{u as g,b as S,c as v,w as k,a as b}from"./index-C0CMstuU.js";import"./state-MbgKLSXQ.js";import"./utils-D1Jy8hEJ.js";const w=()=>{const{ingressUrl:w}=g(),{isConnected:z}=S(),{darkMode:C,toggleDarkMode:y}=v(),[I,A]=m.useState(null),[D,W]=m.useState(0),[$,E]=m.useState(null),[H,M]=m.useState(!1);return m.useEffect(()=>{const e=async()=>{try{await b.healthCheck(),A(!0)}catch{A(!1)}};e();const t=setInterval(e,3e4);return()=>clearInterval(t)},[]),m.useEffect(()=>{const e=async()=>{try{const e=await b.getClients();W(e.length)}catch{W(0)}};e();const t=setInterval(e,1e4);return()=>clearInterval(t)},[]),m.useEffect(()=>{const e=k.on("error",e=>{console.error("WebSocket error detected:",e),E(e.error||"WebSocket connection error"),M(!0)}),t=k.on("auth_error",e=>{console.error("WebSocket auth error:",e),E("Authentication failed. Please login again."),M(!0)}),o=k.on("connected",()=>{E(null),M(!1)});return()=>{e(),t(),o()}},[]),e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1,px:2,py:1,backgroundColor:"background.paper",borderBottom:1,borderColor:"divider"},children:[e.jsxs(o,{direction:"row",spacing:1,sx:{flexGrow:1,alignItems:"center"},children:[e.jsx(n,{title:null===I?"Checking connection...":I?`Connected to ${w||"Home Assistant"}`:"Not connected to Home Assistant",children:e.jsx(r,{icon:I?e.jsx(s,{sx:{fontSize:16}}):e.jsx(a,{sx:{fontSize:16}}),label:I?"HA Connected":"HA Disconnected",color:I?"success":"error",size:"small",variant:"outlined"})}),e.jsx(n,{title:$?`WebSocket error: ${$}`:z?"WebSocket connected - receiving live updates":"WebSocket disconnected - updates paused",children:e.jsx(r,{icon:$?e.jsx(i,{sx:{fontSize:16}}):z?e.jsx(s,{sx:{fontSize:16}}):e.jsx(a,{sx:{fontSize:16}}),label:$?"Error":z?"Live":"Offline",color:$?"error":z?"success":"default",size:"small",variant:"outlined"})}),e.jsx(n,{title:`${D} client(s) connected`,children:e.jsx(r,{icon:e.jsx(c,{sx:{fontSize:16}}),label:`${D} Client${1!==D?"s":""}`,color:"primary",size:"small",variant:"outlined"})})]}),e.jsx(n,{title:"Open API Documentation",children:e.jsxs(l,{href:`${window.location.protocol}//${window.location.hostname}:8099/api-docs`,target:"_blank",rel:"noopener noreferrer",sx:{display:"flex",alignItems:"center",gap:.5,textDecoration:"none",color:"primary.main","&:hover":{textDecoration:"underline"}},children:[e.jsx(d,{sx:{fontSize:18}}),e.jsx(x,{variant:"caption",fontWeight:500,children:"API Docs"})]})}),e.jsx(n,{title:C?"Switch to Light Mode":"Switch to Dark Mode",children:e.jsx(u,{onClick:y,size:"small",color:"inherit",children:C?e.jsx(h,{}):e.jsx(j,{})})}),e.jsx(p,{open:H&&null!==$,autoHideDuration:6e3,onClose:()=>M(!1),anchorOrigin:{vertical:"top",horizontal:"center"},children:e.jsx(f,{onClose:()=>M(!1),severity:"error",variant:"filled",sx:{width:"100%"},children:$})})]})};export{w as StatusBar};
